### SH 表示验证与下一步计划（2025-11-07）

1. **当前背景**
   - R³ flow-matching（129 epoch）在 CASP15 基准上已稳定：10/100 步采样保持优良侧链几何但仍有多步 perplexity 爆炸问题。
   - 为构建“统一密度语义 + 多模态 + 高亲和度 binder”框架，我们尝试用 SH 密度（球谐×径向基）来表示侧链，强调元素标签和 SO(3) 对称。

2. **为何先验证 “SH + 强 decoder”（非扩散）**
   - 若直接在 SH 空间跑扩散、指标不佳，无法区分是表示本身、解码结构还是扩散流程出了问题。
   - 先证明“SH 表示 + 强解码器”在无扩散条件下能把侧链 RMSD 压到 ≈1 Å，就能确认表示无硬瓶颈；之后扩散若退化，才能明确归因于时间调度/采样策略。

3. **现有实验**
   - 新增脚本 `analysis/estimate_sh_reconstruction_limit.py`，对 SH 系数做最小二乘反演：在 `L_max=8, R_bins=24, σ=0.25、noise_std=0.1`、Adam 1000 步设置下，20 个残基的平均 RMSD ≈0.8–0.9 Å，per-atom RMSD 约 0.5–1.5 Å。
   - 这说明 SH 表示的信息量足以恢复侧链到 1–1.5 Å 的范围，当前 4–5 Å 的学习式解码误差来自 decoder 不足。

4. **下一步计划**
   - 训练更强的 SH decoder（跨残基 Transformer/IPA + backbone、自条件，必要时多阶段 refinement），先在非扩散场景把误差逼近理论上限。
   - 将强化后的 decoder 接回 Flow-matching/FBB 管线，对比 R³ 基线的几何与序列指标（TM、RMSD、pLDDT、Perplexity/Recovery），验证 SH 在多步阶段的优势。
   - 并行准备 SH-VAE / SH-LM 方向，为后续多模态预训练和蛋白/RNA/小分子统一表示打基础。
