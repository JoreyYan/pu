### SH vs R³ 项目备忘（2025-11-04）

1. **R³ 基线进展**
   - 直接在 R³ 空间扩散侧链，从多步 Euler / Heun 到最新 flow-matching（129 epoch）已稳定：10/100 步保持芳香环平面性>96%、pLDDT≈66–67。
   - 多步退化的根因（状态离桥、logits OOD）通过 2025-09 系列实验明确，现阶段 R³ 主线用于 benchmark 与保底交付。

2. **SH 尝试回顾**
   - 早期硬解码 (`SHSidechainDecoder`)：SH 密度→网格→PeakExtractor→装配 atom14，噪声和 χ 角柔性导致远端严重偏；证明“纯解析”缺乏鲁棒性。
   - 当前学习式解码 (`SHGeoResHead`)：SH→`SHFeatureHead`→`SH2Atom14`，训练 epoch 27 仍有 atom10–13 RMSD≈4–5 Å，说明现有结构没挖出 SH 表示的潜力。
   - 发现问题：SH 表示本身是稀疏、高维且带群结构的函数展开，仅用 residue 内 MLP 无法捕捉邻域语义、自条件或高频细节。

3. **SH 表示的“有损”与理论上限**
   - “有损”来自参数设置（`L_max=8, R_bins=24, σ≈0.25 Å`）导致高频平滑，并非表示不可逆。
   - 下一步需显式计算 SH→atom14 的最小二乘/解析重建误差；若理论上限 ~1–2 Å，则当前 4–5 Å 的误差主要归因于 decoder 架构而非 SH 本身，可作为继续投入的决策依据。

4. **SH 相比 R³ 的决定性优势**
   - **对称性显式建模**：球谐展开天然遵循 SO(3) 表示，旋转平移用解析矩阵处理；R³ latent 必须靠对齐或网络自学。
   - **元素语义内嵌**：密度通道 = C/N/O/S/…，序列或结构预测始终带化学约束；R³ 需外加条件或正则才能引入同等信息。
   - **函数近似可控**：球谐×径向基的误差由带宽决定，可量化；R³ 压缩对 decoder 能力敏感、缺乏上界估计。
   - **跨模态统一**：扩展 RNA/DNA/小分子/实验密度只需增加元素或修改核函数；R³ 要重新定义原子模板与对齐流程。
   - **预训练与语言对接**：SH 密度可视为“化学语言”，方便做 SH-LM、CLIP 等多模态预训练，序列与结构在同一 token 空间对齐。
   - **多步稳定潜力**：中间态保留元素/几何含义，logits 在扩散轨迹中不易 OOD，有望缓解 R³ 多步爆炸的长期问题。

5. **SH 方向的里程碑（判定是否继续大规模投入）**
   - **理论极限**：计算 SH 重建误差的解析上界，并以此校准 decoder 目标（目标 RMSD ≤1.5–2 Å）。
   - **强 decoder/refiner**：在 `SHFeatureHead` 之上叠加跨残基 Transformer/IPA + backbone、自条件时间 embedding、多阶段 refinement，验证实测 RMSD 接近理论上限且多步 perplexity 优于 R³。
   - **SH 编码器/预训练**：训练 SH-VAE / SH-CLIP / SH-LM，将稀疏系数压成语义 embedding，并在大规模密度+序列上验证“密度语言”提升序列预测/分类头稳定性。
   - **多模态统一实验**：在同一 SH 框架下支持蛋白、RNA、DNA、小分子乃至 cryo-EM 密度，完成联合生成或精炼的证明型任务。
   - **应用验证**：利用 SH 表示生成/优化高亲和度 binder，或在实验密度对齐、序列-结构协同设计上给出可发表的案例。

6. **Nature 级成果路线**
   - 核心卖点：**统一密度语义 + 多模态预训练 + 跨分子生成**。目标是把 SH 表示打造成“蛋白/RNA/DNA/小分子/实验密度/序列语言模型”的共同底座，并给出实验证据（高亲和度 binder、EM 对齐等）。
   - R³ 主线继续作为 benchmark，与 SH 版本做对照；在论文中强调 SH 在多模态、对称性、语言联动上的优势与实测收益。
   - 里程碑过后，整合高亲和度设计、真实数据验证、理论分析，即可形成具备高新颖度和影响力的投稿包。

7. **工作分工建议**
   - **R³**：维持现有脚本可跑、持续记录指标，作为对照与保底 pipeline。
   - **SH**：集中资源攻克理论极限、强 decoder、预训练与统一多模态实验，逐步构建 Nature 级故事线。
